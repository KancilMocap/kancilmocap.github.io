# Authentication Methods

The first 2 bytes would be used to describe the authentication method, and the remaining bytes would be used to describe the authentication requirement. All numbers reference below are in big endian for readability. All purpose octets should use the value 0xC9 (201 in base 10).

## None

Server requirement: Empty response
Client request: None

## Plaintext

2 byte requirement: 0001
Server requirement: None
Client request: UTF-8 string of plaintext password

## PKCS12-PBKDF

In this implementation of PKCS12-PBKDF, the iterations would be determined by the server. A salt must be provided, and it should be generated by the client and sent to the server within the client request. Blake2b would be used as the hashing algorithm.

2 byte requirement: 0002
Server requirement: 4 bytes representing an uint32 for the iteration count.
Client request: First 2 bytes represent a uint16 for the length of the derived key in bytes, followed by the derived key. Then, another 2 bytes representing a uint16 for the length of the salt in bytes would be provided, followed by the length of the salt.

## HKDF

In this implementation of HKDF, the salt would be provided by the client and the info used would be the server version as returned in [module FFFE code 0005](https://kancil.moe/kijang/tcp-module-system#control-module-server---fffe). Blake2b would be used as the hashing algorithm.

2 byte requirement: 0003
Server requirement: None
Client request: First 2 bytes represent a uint16 for the length of the derived key in bytes, followed by the derived key. Then, another 2 bytes representing a uint16 for the length of the salt in bytes would be provided, followed by the length of the salt.
